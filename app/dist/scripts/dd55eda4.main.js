"use strict";function succOrNot(a,b){var c=paper.circle(375,300,105).attr({fill:a});paper.text(370,300,b).attr({fill:"white","font-size":55,"stroke-width":3}),c.stop().mouseover(function(){this.animate({transform:"s1.1 1.1 375 300"},750,"elastic")}),c.stop().mouseout(function(){this.animate({transform:"375 300"},750,"elastic")})}var myRafa={},paper;Raphael.fn.pieChart=function(a,b,c,d,e,f){function g(a,b,c,d,e,f){var g=a+c*Math.cos(-d*i),j=a+c*Math.cos(-e*i),k=b+c*Math.sin(-d*i),l=b+c*Math.sin(-e*i);return h.path(["M",a,b,"L",g,k,"A",c,c,0,+(e-d>180),0,j,l,"z"]).attr(f)}for(var h=this,i=Math.PI/180,j=this.set(),k=0,l=0,m=0,n=function(n){var o=d[n],p=360*o/l,q=k+p/2,r=Raphael.hsb(m,.5,.5),s=500,t=30,u=Raphael.hsb(m,1,1),v=g(a,b,c,k,k+p,{fill:"90-"+u+"-"+r,stroke:f,"stroke-width":3}),w=h.text(a+(c+t+-5)*Math.cos(-q*i),b+(c+t+0)*Math.sin(-q*i),e[n]).attr({fill:u,stroke:"none",opacity:0,"font-size":20});v.mouseover(function(){v.stop().animate({transform:"s1.1 1.1 "+a+" "+b},s,"elastic"),w.stop().animate({opacity:1},s,"elastic")}).mouseout(function(){v.stop().animate({transform:""},s,"elastic"),w.stop().animate({opacity:0},s)}),k+=p,j.push(v),j.push(w),m+=.1},o=0,p=d.length;p>o;o++)l+=d[o];for(o=0;p>o;o++)n(o);return j},myRafa.init=function(a,b,c){paper=Raphael(a,b,c)},myRafa.drawMessage=function(a,b,c,d,e,f,g){++b<a[f].length?paper.text(b*c,d,a[f][b]).attr({fill:"blue","font-size":e,opacity:0}).animate({opacity:1},g,function(){myRafa.drawMessage(a,b,c,d,e,f,g)}):a[++f]&&myRafa.drawMessage(a,0,c,3*d,e,f,g)},myRafa.bublik=function(a){var b=a.total/100,c=a.bits*b,d=Math.abs(a.total-a.bits)*b;d&&0!==c?paper.pieChart(375,300,105,[d,c],["-","+"],"#22a"):a.bits===a.total?succOrNot("green",a.total+"/"+a.bits):succOrNot("red",a.total+"/0"),paper.text(700,400,"Home").attr({fill:"white","font-size":25,cursor:"pointer"}).click(function(){window.location.reload()})};var row=React.createClass({displayName:"row",handleClick:function(a){var b,c=$(a.target).attr("type");switch(c){case"trueFalse":b=truefalse;break;case"userInput":b=userinput;break;case"choices":b=choice;break;case"choiceHint":b=choicehint;break;default:console.log("oop what is that?")}b&&(myGlobal.sourceOfCurr=$(a.target).attr("src"),React.renderComponent(b,document.getElementById("page-content")))},render:function(){var a=this.props.td.map(function(a){return React.DOM.td({onClick:this.handleClick,className:"hand",src:a.src,type:a.Qtype,key:Math.random()},a.name)}.bind(this));return React.DOM.tr(null,a)}}),makeGrid=React.createClass({displayName:"makeGrid",render:function(){var a=[],b=this.props.data;if(b.headers.length>2)for(var c=0;c<=b.headers.length/b.perLine;c++){var d=c*b.perLine,e=c*b.perLine+b.perLine;a.push(row({td:b.headers.slice(d,e),key:Math.random()}))}else a.push(row({td:b.headers}));return React.DOM.tbody(null,a)}}),obj1=React.createClass({displayName:"obj1",componentDidMount:function(){this.makeGridNice()},render:function(){return React.DOM.div({className:"divcenter"},React.DOM.table(null,makeGrid({data:myGlobal.startPage})))},makeGridNice:function(){var a=$(".divcenter table tr:last td").length,b=$(".divcenter table tr:first td").length;a!==b&&(b-a>1&&a>1?($(".divcenter table tr:last").find(":last-child").attr("colspan",2),$(".divcenter table tr:last").find(":first-child").attr("colspan",2)):$(".divcenter table tr:last").find(":last-child").attr("colspan",1+(b-a)))}});React.renderComponent(obj1(null),document.getElementById("page-content"));var obj3=React.createClass({displayName:"obj3",getInitialState:function(){return{data:"Loading...",secondsElapsed:0,minutesElapsed:0,userTime:"00:00 min",onQuestion:1,userGuess:0,totalQuestion:0,template:null}},setUserResult:function(a,b){this.setState({onQuestion:a+1}),this.setState({userGuess:this.state.userGuess+b}),this.updateNavigation()},getResults:function(){return{time:this.state.userTime,total:this.props.total,bits:this.state.userGuess}},updateNavigation:function(){this.setState({data:Mustache.render(this.state.template,{on:this.state.onQuestion,total:this.props.total,guess:this.state.userGuess,time:this.state.userTime})})},tick:function(){this.setState({secondsElapsed:this.state.secondsElapsed+1}),60==this.state.secondsElapsed&&(this.setState({minutesElapsed:this.state.minutesElapsed+1}),this.setState({secondsElapsed:0})),this.setState({userTime:("0"+this.state.minutesElapsed).slice(-2)+":"+("0"+this.state.secondsElapsed).slice(-2)+" min"}),this.updateNavigation()},componentDidMount:function(){this.getUserNavigation(),this.interval=setInterval(this.tick,999)},getUserNavigation:function(){$.ajax({type:"GET",url:"templates/navigation.mst",dataType:"text"}).success(function(a){var b=Mustache.render(a,{on:this.state.onQuestion,total:this.state.totalQuestion,guess:this.state.userGuess,time:this.state.userTime});this.setState({data:b}),this.setState({template:a})}.bind(this))},componentWillUnmount:function(){clearInterval(this.interval)},render:function(){return React.DOM.div({dangerouslySetInnerHTML:{__html:this.state.data}})}}),navigation=obj3,makeTFQ=React.createClass({displayName:"makeTFQ",getInitialState:function(){return{view:"<h1>Loading...</h1>",questIndex:0,data:this.props.it,userAttempt:0,userCanTry:0,template:{}}},componentDidMount:function(){this.getQuestScelet()},refreshData:function(a){this.setState({data:a.questions}),this.setState({userCanTry:a.canTry}),this.getFreshTemplate()},getQuestScelet:function(){$.ajax({type:"GET",url:"templates/truefalse.mst",dataType:"text"}).success(function(a){this.setState({template:a})}.bind(this))},checkAnswer:function(a){this.setState({userAttempt:this.state.userAttempt+1}),a===this.state.data[this.state.questIndex].answer?(this.props.cntrl.setUserResult(this.state.questIndex,1),this.goToNext(),this.interactWithUser("up")):(this.state.userCanTry==this.state.userAttempt&&(this.props.cntrl.setUserResult(this.state.questIndex,0),this.goToNext()),this.interactWithUser("left"))},interactWithUser:function(a){$(".shake").effect("shake",{direction:a,times:2,distance:5},250)},goToNext:function(){return this.state.data.length-1===this.state.questIndex?void myGlobal.measureUserPerformance(this.props.cntrl.getResults()):(this.setState({userAttempt:0}),this.setState({questIndex:this.state.questIndex+1}),void this.getFreshTemplate())},getFreshTemplate:function(){var a=Mustache.render(this.state.template,{question:this.state.data[this.state.questIndex].question});this.setState({view:a})},render:function(){return React.DOM.div({dangerouslySetInnerHTML:{__html:this.state.view}})}}),obj2=React.createClass({displayName:"obj2",getInitialState:function(){return{data:[{question:"",answer:""}],control:null,dataLn:0}},componentDidMount:function(){this.handleAnswer(),this.setState({control:this.refs.updateNav}),this.loadServerData()},loadServerData:function(){myGlobal.sourceOfCurr?$.get("questions/"+myGlobal.sourceOfCurr+".json",function(a){a.questions&&a.canTry?(this.refs.userInput.refreshData(a),this.setState({dataLn:a.questions.length})):(alert("The JSON file is builded wrong...?"),window.location.reload())}.bind(this)).fail(function(){alert("Sorry but I can not load data from Server ! \nLet's try again later?"),window.location.reload()}):(alert("The souce of Questions not specified.\nCheck config.js for more info!!!"),window.location.reload())},handleAnswer:function(){$(".quest-gen").bind("click",function(a){if("BUTTON"===a.target.nodeName){var b=$(a.target).text().toLowerCase();this.refs.userInput.checkAnswer("false"===b?!1:!0)}}.bind(this))},render:function(){return React.DOM.div(null,navigation({ref:"updateNav",total:this.state.dataLn}),React.DOM.div({className:"quest-gen"},React.DOM.div({className:"shake"},makeTFQ({it:this.state.data,cntrl:this.state.control,ref:"userInput"}))))}}),truefalse=obj2(null),makeUIQ=React.createClass({displayName:"makeUIQ",getInitialState:function(){return{view:"<h1>Loading...</h1>",questIndex:0,data:this.props.it,userAttempt:0,userCanTry:0,template:{}}},componentDidMount:function(){this.getQuestScelet()},refreshData:function(a){this.setState({data:a.questions}),this.setState({userCanTry:a.canTry}),this.getFreshTemplate()},getQuestScelet:function(){$.ajax({type:"GET",url:"templates/userinput.mst",dataType:"text"}).success(function(a){this.setState({template:a})}.bind(this))},checkAnswer:function(){this.setState({userAttempt:this.state.userAttempt+1});var a=$(".userinput").val().toLowerCase().trim();console.log(a+" == "+this.state.data[this.state.questIndex].answer.toLowerCase()),a===this.state.data[this.state.questIndex].answer.toLowerCase()?(this.goToNext(),this.props.cntrl.setUserResult(this.state.questIndex,1),this.interactWithUser("up")):(this.state.userCanTry==this.state.userAttempt&&(this.goToNext(),this.props.cntrl.setUserResult(this.state.questIndex,0)),this.interactWithUser("left"))},interactWithUser:function(a){$(".shake").effect("shake",{direction:a,times:2,distance:5},250)},getFreshTemplate:function(){var a=Mustache.render(this.state.template,{question:this.state.data[this.state.questIndex].question});this.setState({view:a})},goToNext:function(){return this.state.data.length-1===this.state.questIndex?void myGlobal.measureUserPerformance(this.props.cntrl.getResults()):(this.setState({userAttempt:0}),this.setState({questIndex:this.state.questIndex+1}),void this.getFreshTemplate())},render:function(){return React.DOM.div({dangerouslySetInnerHTML:{__html:this.state.view}})}}),obj4=React.createClass({displayName:"obj4",getInitialState:function(){return{data:[{question:"",answer:""}],control:null,dataLn:0}},componentDidMount:function(){this.handleAnswer(),this.setState({control:this.refs.updateNav}),this.loadServerData()},loadServerData:function(){myGlobal.sourceOfCurr?$.get("questions/"+myGlobal.sourceOfCurr+".json",function(a){a.questions&&a.canTry?(this.refs.userInput.refreshData(a),this.setState({dataLn:a.questions.length})):(alert("The JSON file is builded wrong...?"),window.location.reload())}.bind(this)).fail(function(){alert("Sorry but I can not load data from Server ! \nLet's try again later?"),window.location.reload()}):(alert("The souce of Questions not specified.\nCheck config.js for more info!!!"),window.location.reload())},handleAnswer:function(){$(".quest-gen").bind("click keydown",function(a){("BUTTON"===a.target.nodeName||13===(a.keyCode||a.which))&&this.refs.userInput.checkAnswer()}.bind(this))},render:function(){return React.DOM.div(null,navigation({ref:"updateNav",total:this.state.dataLn}),React.DOM.div({className:"quest-gen"},React.DOM.div({className:"shake"},makeUIQ({it:this.state.data,cntrl:this.state.control,ref:"userInput"}))))}}),userinput=obj4(null),makeCHQ=React.createClass({displayName:"makeCHQ",getInitialState:function(){return{view:"<h1>Loading...</h1>",questIndex:0,data:this.props.it,userAttempt:0,userCanTry:0,template:{}}},componentDidMount:function(){this.getQuestScelet()},refreshData:function(a){this.setState({data:a.questions}),this.setState({userCanTry:a.canTry}),this.getFreshTemplate()},getQuestScelet:function(){$.ajax({type:"GET",url:"templates/choices.mst",dataType:"text"}).success(function(a){this.setState({template:a})}.bind(this))},checkAnswer:function(a){this.setState({userAttempt:this.state.userAttempt+1}),a===this.state.data[this.state.questIndex].answer?(this.goToNext(),this.props.cntrl.setUserResult(this.state.questIndex,1),this.interactWithUser("up")):(this.state.userCanTry==this.state.userAttempt&&(this.goToNext(),this.props.cntrl.setUserResult(this.state.questIndex,0)),this.interactWithUser("left"))},interactWithUser:function(a){$(".shake").effect("shake",{direction:a,times:2,distance:5},250)},goToNext:function(){return this.state.data.length-1===this.state.questIndex?void myGlobal.measureUserPerformance(this.props.cntrl.getResults()):(this.setState({userAttempt:0}),this.setState({questIndex:this.state.questIndex+1}),void this.getFreshTemplate())},getFreshTemplate:function(){var a=Mustache.render(this.state.template,{question:this.state.data[this.state.questIndex].question,ch1:this.state.data[this.state.questIndex].choices[0]||"?",ch2:this.state.data[this.state.questIndex].choices[1]||"?",ch3:this.state.data[this.state.questIndex].choices[2]||"?",ch4:this.state.data[this.state.questIndex].choices[3]||"?"});this.setState({view:a})},render:function(){return React.DOM.div({dangerouslySetInnerHTML:{__html:this.state.view}})}}),obj5=React.createClass({displayName:"obj5",getInitialState:function(){return{data:[{question:"",answer:""}],control:null,dataLn:0}},componentDidMount:function(){this.handleAnswer(),this.setState({control:this.refs.updateNav}),this.loadServerData()},loadServerData:function(){myGlobal.sourceOfCurr?$.get("questions/"+myGlobal.sourceOfCurr+".json",function(a){a.questions&&a.canTry?(this.refs.userInput.refreshData(a),this.setState({dataLn:a.questions.length})):alert("The JSON file is builded wrong...?")}.bind(this)).fail(function(a,b){console.log(a,b)}):(alert("The souce of Questions not specified.\nCheck myGlobalig.js for more info!!!"),window.location.reload())},handleAnswer:function(){$(".quest-gen").bind("click",function(a){if("BUTTON"===a.target.nodeName){var b=$(a.target).text().toLowerCase();this.refs.userInput.checkAnswer(b)}}.bind(this))},render:function(){return React.DOM.div(null,navigation({ref:"updateNav",total:this.state.dataLn}),React.DOM.div({className:"quest-gen"},React.DOM.div({className:"shake"},makeCHQ({it:this.state.data,cntrl:this.state.control,ref:"userInput"}))))}}),choice=obj5(null),makeCHQ=React.createClass({displayName:"makeCHQ",getInitialState:function(){return{view:"<h1>Loading...</h1>",questIndex:0,data:this.props.it,userAttempt:0,userCanTry:0,template:{}}},componentDidMount:function(){this.getQuestScelet()},showHint:function(a){a.preventDefault(),$(".tooltip-hint").toggle()},refreshData:function(a){this.setState({data:a.questions}),this.setState({userCanTry:a.canTry}),this.getFreshTemplate()},getQuestScelet:function(){$.ajax({type:"GET",url:"templates/choicehint.mst",dataType:"text"}).success(function(a){this.setState({template:a})}.bind(this))},checkAnswer:function(a){var b=$(a.target).text().toLowerCase();this.setState({userAttempt:this.state.userAttempt+1}),b===this.state.data[this.state.questIndex].answer?(this.goToNext(),this.props.cntrl.setUserResult(this.state.questIndex,1),this.interactWithUser("up")):(this.state.userCanTry<=this.state.userAttempt&&(this.goToNext(),this.props.cntrl.setUserResult(this.state.questIndex,0)),this.interactWithUser("left"))},interactWithUser:function(a){$(".shake").effect("shake",{direction:a,times:2,distance:5},250)},goToNext:function(){return this.state.data.length-1===this.state.questIndex?void myGlobal.measureUserPerformance(this.props.cntrl.getResults()):(this.setState({userAttempt:0}),this.setState({questIndex:this.state.questIndex+1}),void this.getFreshTemplate())},getFreshTemplate:function(){var a=Mustache.render(this.state.template,{question:this.state.data[this.state.questIndex].question,ch1:this.state.data[this.state.questIndex].choices[0]||"?",ch2:this.state.data[this.state.questIndex].choices[1]||"?",ch3:this.state.data[this.state.questIndex].choices[2]||"?",ch4:this.state.data[this.state.questIndex].choices[3]||"?",hint:this.state.data[this.state.questIndex].hint||"think"});this.setState({view:a})},render:function(){return React.DOM.div({dangerouslySetInnerHTML:{__html:this.state.view}})}}),obj5=React.createClass({displayName:"obj5",getInitialState:function(){return{data:[{question:"",answer:""}],control:null,dataLn:0}},componentDidMount:function(){this.handleAnswer(),this.setState({control:this.refs.updateNav}),this.loadServerData()},loadServerData:function(){myGlobal.sourceOfCurr?$.get("questions/"+myGlobal.sourceOfCurr+".json",function(a){a.questions&&a.canTry?(this.refs.userInput.refreshData(a),this.setState({dataLn:a.questions.length})):alert("The JSON file is builded wrong...?")}.bind(this)).fail(function(a,b){console.log(a,b)}):(alert("The souce of Questions not specified.\nCheck config.js for more info!!!"),window.location.reload())},handleAnswer:function(){$(".quest-gen").bind("click",function(a){"BUTTON"===a.target.nodeName?this.refs.userInput.checkAnswer(a):"A"===a.target.nodeName&&this.refs.userInput.showHint(a)}.bind(this))},render:function(){return React.DOM.div(null,navigation({ref:"updateNav",total:this.state.dataLn}),React.DOM.div({className:"quest-gen"},React.DOM.div({className:"shake"},makeCHQ({it:this.state.data,cntrl:this.state.control,ref:"userInput"}))))}}),choicehint=obj5(null);